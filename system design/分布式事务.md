# 分布式事务
分布式事务难的原因是涉及到网络的不稳定，网络可能成功、失败、超时，
**超时**代表请求的发起者不能确定接受者是否成功处理了请求，这也是造成诸多问题的诱因。
## 分布式事务解决方案
### 两阶段提交2PC
两阶段提交是一种使分布式系统中所有节点在进行事务提交时保持一致性而设计的一种协议
#### 成立的条件
参与者本地事务具备ACID特性。
####  角色
协调者（Coordinator）和 参与者（Cohort）
#### 两个阶段：投票阶段 和 提交阶段
##### 投票阶段
- 协调者向所有参与者发送查询提交的消息，并等到收到所有参与者的回复。
- 参与者执行交易，直到他们被要求提交的时候。他们各自在自己的undo log和redo log中写下一条记录。
- 如果参与者的行动成功了，每个参与者都会回复一个Agreement（参与者投票同意提交），或者如果参与者遇到故障而无法提交，则会回复一个Abort消息（参与者投票反对，不提交）。
##### 提交阶段
###### 成功

缺点：
两阶段提交协议的最大缺点是，它是一个阻塞协议。如果协调人永久性地失败，一些参与者将永远无法解决他们的交易。在一个参与者向协调者发送协议消息后，它将被阻塞，直到收到提交或回滚。


引用：[https://draveness.me/distributed-transaction-principle/][1]

[1]:	https://draveness.me/distributed-transaction-principle/